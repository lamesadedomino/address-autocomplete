<!DOCTYPE html>
<html>
  <head>
    <title>Google Places Autocomplete</title>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">
    </script>
    <style>
      body {
        font-family: sans-serif;
        padding: 0;
        margin: 0;
      }
      #autocomplete {
        width: 90%;
        margin: 10px auto;
        padding: 10px;
        font-size: 16px;
      }
      button {
        display: block;
        margin: 10px auto;
        padding: 6px 12px;
        font-size: 14px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <input id="autocomplete" placeholder="Start typing your address" type="text" />
    <button onclick="clearAddress()">Clear</button>

    <script>
      let autocomplete;
      function initAutocomplete() {
        autocomplete = new google.maps.places.Autocomplete(
          document.getElementById("autocomplete"),
          { types: ["address"] }
        );
        autocomplete.addListener("place_changed", () => {
          const place = autocomplete.getPlace();
          const components = {
            street_number: "",
            route: "",
            locality: "",
            administrative_area_level_1: "",
            postal_code: ""
          };
          for (const comp of place.address_components) {
            const type = comp.types[0];
            if (components[type] !== undefined) {
              components[type] = comp.long_name;
            }
          }
          const street = `${components.street_number} ${components.route}`.trim();
          const city = components.locality;
          const state = components.administrative_area_level_1;
          const zip = components.postal_code;

          // Send data to Wix
          window.parent.postMessage({ street, city, state, zip }, "*");
        });
      }

      function clearAddress() {
        document.getElementById("autocomplete").value = "";
        window.parent.postMessage({ street: "", city: "", state: "", zip: "" }, "*");
      }

      window.onload = initAutocomplete;
    </script>
  </body>
</html>
